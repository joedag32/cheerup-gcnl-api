<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Azure Text Analytics REST API</title>
  </head>
  <body>
    <h1>Azure Text Analytics REST API</h1>
    <label for="testValue">Test Value:</label>
    <input type="text" id="testValue" name="testValue" value="Thundercats" />
    <button type="button" id="analyzeButton">Analyze Text!</button>
    <h2>Returned Object</h2>
    <div id="returnedObject"></div>
    <script>
      /* declare some variables */
      const functionURL = "https://eastus.api.cognitive.microsoft.com/text/analytics/v3.0/keyPhrases";
      const input = document.getElementById("testValue");
      const analyzeButton = document.getElementById("analyzeButton");
      const objectOutput = document.getElementById("returnedObject");
      const testValue = input.value;
      /* set value of input field as the body to be sent via the POST request */
      const postData = {
        name: testValue
      };

      /* update value of input to pass */
      input.addEventListener("input", updateValue);
      function updateValue(e) {
        postData.name = e.target.value;
        console.log(postData);
      }

      analyzeButton.addEventListener("click", analyzeText);
      /* call Azure Function via HTTP POST and return a very simple object  */
      function analyzeText(e) {
        fetch(functionURL, {
          method: "POST",
          headers: {
            "Ocp-Apim-Subscription-Key":
              "sVTGssIWRl2aHbyFWRXIapWMK4DHOIsIiWRZK5W1ky5F/jaFDz7Jtg==",
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          body: JSON.stringify(postData)
        })
          .then(res => res.json())
          .then(data => {
            console.log(data);
            objectOutput.innerHTML = data.key;
          })
          .catch(error => {
            console.error(error);
          });
      }
    </script>
  </body>
</html>
